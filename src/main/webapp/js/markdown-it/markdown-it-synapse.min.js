/*! markdown-it-synapse 1.0.18 https://github.com/jay-hodgson/markdown-it-synapse @license MIT */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.markdownitSynapse=e()}}(function(){return function e(n,r,t){function s(a,i){if(!r[a]){if(!n[a]){var p="function"==typeof require&&require;if(!i&&p)return p(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};n[a][0].call(c.exports,function(e){var r=n[a][1][e];return s(r?r:e)},c,c.exports,e,n,r,t)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<t.length;a++)s(t[a]);return s}({1:[function(e,n,r){"use strict";function t(e,n){var r,t,s,o,a=null;for(r=e.split("?"),t=r[1].split("&"),s=0;s<t.length;s++)o=t[s].split("="),n===o[0]&&(a=o[1]);return a}function s(e){if(e>=8192&&8202>=e)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function o(e,n,r){return r=r||0,e.substr(r,n.length)===n}function a(e,n){var r,o,a,u,f,x,g=e.posMax,m=e.pos,v="widgetContainer";if(m+3>=g)return!1;if(n)return!1;if(64===e.src.charCodeAt(m)){if(m>0&&!s(e.src.charCodeAt(e.pos-1)))return!1;for(;e.pos<g&&!s(e.src.charCodeAt(e.pos));)e.pos++;return o=e.src.slice(m+1,e.pos),e.posMax=e.pos,e.pos=m+1,a=e.push("synapse_open","span",1),a.markup="@",a.attrs=[["widgetparams","badge?alias="+o],["class",v],["id","widget-"+p+i]],a=e.push("link_open","a",1),a.attrs=[["href","https://www.synapse.org/Portal/aliasredirector?alias="+o]],a.markup="autolink",a.info="auto",a=e.push("text","",0),a.content="@"+o+" ",a=e.push("link_close","a",-1),a.markup="autolink",a.info="auto",a=e.push("text","",0),a=e.push("synapse_close","span",-1),e.pos=e.posMax+1,e.posMax=g,p+=1,!0}if(36!==e.src.charCodeAt(m))return!1;if(123!==e.src.charCodeAt(m+1))return!1;for(e.pos=m+2;e.pos<g;){if(125===e.src.charCodeAt(e.pos)){r=!0;break}e.md.inline.skipToken(e)}return r&&m+2!==e.pos?(o=e.src.slice(m+2,e.pos),u=o.replace(d,"$1"),0===o.lastIndexOf(h,0)?(u+="&footnoteId="+c,a=e.push("synapse_reference_open","span",1),a.attrs=[["id","wikiReference"+c]],a=e.push("synapse_reference_close","span",-1),f=decodeURIComponent(u),x=t(f,"text"),x&&(l+="${bookmark?text=["+c+"]&bookmarkID=wikiReference"+c+"} "+x+"\n"),c++,v="inlineWidgetContainer"):0===o.lastIndexOf(k,0)&&(a=e.push("synapse_footnote_target_open","span",1),a.attrs=[["id","wikiFootnote"+c]],a=e.push("synapse_footnote_target_close","span",-1),c++,v="inlineWidgetContainer"),e.posMax=e.pos,e.pos=m+2,a=e.push("synapse_open","span",1),a.markup="${",a.attrs=[["widgetparams",u],["class",v],["id","widget-"+p+i]],a=e.push("text","",0),a.content="<Synapse widget>",a=e.push("synapse_close","span",-1),a.markup="}",e.pos=e.posMax+1,e.posMax=g,p+=1,!0):(e.pos=m,!1)}var i,p,u,c,l,f,d=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g,h="reference?",k="bookmark?",x=new RegExp("^syn([0-9]+[.]?[0-9]*)+"),g=new RegExp("^([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/w \\.-]*)*\\/?.*$"),m=new RegExp("^doi:10[.]{1}[0-9]+[/]{1}[a-zA-Z0-9_.]+$"),v=new RegExp("^\\s*(width[=]{1})?\\s*(.*)[}]{1}\\s*$"),w=new RegExp('^\\s*(text[=]{1}["]{1})?\\s*(.*)["]{1}[}]{1}\\s*$'),_=new RegExp("^\\s*[*-+>]{1}[^|]*$"),y=new RegExp("^\\s*\\w+\\s*[.)]{1}[^|]*$"),C=new RegExp("^[`]{3}s*([a-zA-Z_0-9-]*)s*$"),M=new RegExp("[ ]{7}","g");n.exports=function(e,n,r){p=0,u=0,c=1,i=n,l="",f="",r&&(f=r),e.inline.ruler.after("emphasis","synapse",a)},n.exports.footnotes=function(){return l},n.exports.resetFootnoteId=function(){c=1},n.exports.preprocessMarkdown=function(e){for(var n="",r=e.split("\n"),t=!1,s=!1,o=!1,a=0;a<r.length;a++)C.test(r[a])&&(o=!o),o||(s=_.test(r[a])||y.test(r[a]),s&&(r[a]=r[a].replace(M,"    ")),t&&!s&&(n+="\n"),t=s),n+=r[a]+"\n";return n},n.exports.init_markdown_it=function(e,n,r,t,s,a,p,c,l,d){function h(){var n=e.renderer.rules.link_open||function(e,n,r,t,s){return s.renderToken(e,n,r)};e.renderer.rules.link_open=function(e,r,t,s,a){var i=e[r].attrIndex("target"),p=e[r].attrIndex("href");return 0>i?(0>p||!o(e[r].attrs[p][1],"#!"))&&e[r].attrPush(["target","_blank"]):e[r].attrs[i][1]="_blank",n(e,r,t,s,a)}}function k(){var n=e.renderer.rules.table_open||function(e,n,r,t,s){return s.renderToken(e,n,r)};e.renderer.rules.table_open=function(e,r,t,s,o){var a=e[r].attrIndex("class");return 0>a?e[r].attrPush(["class","markdowntable"]):e[r].attrs[a][1]+="markdowntable",n(e,r,t,s,o)}}function _(){e.linkify.set({fuzzyLink:!1}),e.linkify.add("syn",{validate:function(e,n,r){var t=e.slice(n);return r.re.synapse||(r.re.synapse=new RegExp("^([0-9]{3,}[.]?[0-9]*(\\/wiki\\/[0-9]+)?)+(?!_)(?=$|"+r.re.src_ZPCc+")")),r.re.synapse.test(t)?t.match(r.re.synapse)[0].length:0},normalize:function(e){e.url=f+"#!Synapse:"+e.url.replace(/[.]/,"/version/")}}),e.linkify.add("doi:10.",{validate:function(e,n,r){var t=e.slice(n);return r.re.doi||(r.re.doi=new RegExp("^[0-9]+[/]{1}[a-zA-Z0-9_.]+(?!_)(?=$|"+r.re.src_ZPCc+")")),r.re.doi.test(t)?t.match(r.re.doi)[0].length:0},normalize:function(e){e.url="http://dx.doi.org/"+e.url}})}function y(n,r){var t,s,o,a,i,p,u,c,l,d,h="",k=n.pos,v=n.posMax,w=n.pos,_=e.helpers.parseLinkLabel,y=e.helpers.parseLinkDestination,C=e.helpers.parseLinkTitle,M=e.utils.isSpace,b=e.utils.normalizeReference;if(91!==n.src.charCodeAt(n.pos))return!1;if(i=n.pos+1,a=_(n,n.pos,!0),0>a)return!1;if(p=a+1,v>p&&40===n.src.charCodeAt(p)){for(p++;v>p&&(s=n.src.charCodeAt(p),M(s)||10===s);p++);if(p>=v)return!1;if(w=p,u=y(n.src,p,n.posMax),u.ok){var A=u.str;x.test(A)?u.str=f+"#!Synapse:"+A.replace(/[.]/,"/version/"):g.test(A)?u.str="http://"+A:m.test(A)&&(u.str="http://dx.doi.org/"+A),h=n.md.normalizeLink(u.str),n.md.validateLink(h)?p=u.pos:h=""}for(w=p;v>p&&(s=n.src.charCodeAt(p),M(s)||10===s);p++);if(u=C(n.src,p,n.posMax),v>p&&w!==p&&u.ok)for(l=u.str,p=u.pos;v>p&&(s=n.src.charCodeAt(p),M(s)||10===s);p++);else l="";if(p>=v||41!==n.src.charCodeAt(p))return n.pos=k,!1;p++}else{if("undefined"==typeof n.env.references)return!1;if(v>p&&91===n.src.charCodeAt(p)?(w=p+1,p=_(n,p),p>=0?o=n.src.slice(w,p++):p=a+1):p=a+1,o||(o=n.src.slice(i,a)),c=n.env.references[b(o)],!c)return n.pos=k,!1;h=c.href,l=c.title}return r||(n.pos=i,n.posMax=a,d=n.push("link_open","a",1),d.attrs=t=[["href",h]],l&&t.push(["title",l]),n.md.inline.tokenize(n),d=n.push("link_close","a",-1)),n.pos=p,n.posMax=v,!0}function C(e,n,r){for(var t,s,o,a=r,i=n,p=e.charCodeAt(r);i>a&&e.charCodeAt(a)===p;)a++;return t=a-r,s=!0,o=!0,{can_open:s,can_close:o,length:t}}function M(e,n){var r,t,s,o=e.pos,a=e.src.charCodeAt(o);if(n)return!1;if(95!==a&&42!==a)return!1;for(t=C(e.src,e.posMax,e.pos),r=0;r<t.length;r++)s=e.push("text","",0),s.content=String.fromCharCode(a),e.delimiters.push({marker:a,jump:r,token:e.tokens.length-1,level:e.level,end:-1,open:t.can_open,close:t.can_close});return e.pos+=t.length,!0}function b(){e.set({html:!1,breaks:!0,linkify:!0,maxNesting:100}),e.disable(["heading"]),e.disable(["lheading"]),e.use(n).use(r).use(t).use(s).use(a).use(p).use(l).use(d),e.use(c,"row",{marker:"{row}",minMarkerCount:1,render:function(e,n){var r;return r=1===e[n].nesting?'<div class="container-fluid"><div class="row">':"</div></div>\n"},validate:function(){return!0}}),e.use(c,"column",{marker:"{column",endMarker:"{column}",minMarkerCount:1,render:function(n,r){var t,s;return 1===n[r].nesting?(t=v.exec(n[r].info),s='<div class="col-sm-'+e.utils.escapeHtml(t[2])+'">'):s="</div>\n",s},validate:function(e){return v.test(e)}}),e.use(c,"nav",{marker:"{nav",endMarker:"{nav}",minMarkerCount:1,render:function(n,r){var t,s;return 1===n[r].nesting?(t=w.exec(n[r].info),s='<div id="nav-target-'+u+i+'" target-text="'+e.utils.escapeHtml(t[2])+'">',u+=1):s="</div>\n",s},validate:function(e){return w.test(e)}}),h(),_(),k(),e.inline.ruler.at("link",y),e.inline.ruler.at("emphasis",M)}b()}},{}]},{},[1])(1)});
