/*! markdown-it-synapse 1.0.16 https://github.com/jay-hodgson/markdown-it-synapse @license MIT */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r.markdownitSynapse=e()}}(function(){return function e(r,n,t){function s(i,a){if(!n[i]){if(!r[i]){var p="function"==typeof require&&require;if(!a&&p)return p(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[i]={exports:{}};r[i][0].call(c.exports,function(e){var n=r[i][1][e];return s(n?n:e)},c,c.exports,e,r,n,t)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<t.length;i++)s(t[i]);return s}({1:[function(e,r,n){"use strict";function t(e,r){var n,t,s,o,i=null;for(n=e.split("?"),t=n[1].split("&"),s=0;s<t.length;s++)o=t[s].split("="),r===o[0]&&(i=o[1]);return i}function s(e){if(e>=8192&&8202>=e)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function o(e,r,n){return n=n||0,e.substr(n,r.length)===r}function i(e,r){var n,o,i,l,k,x,g=e.posMax,m=e.pos,w="widgetContainer";if(m+3>=g)return!1;if(r)return!1;if(64===e.src.charCodeAt(m)){if(m>0&&!s(e.src.charCodeAt(e.pos-1)))return!1;for(;e.pos<g&&!s(e.src.charCodeAt(e.pos));)e.pos++;return o=e.src.slice(m+1,e.pos),e.posMax=e.pos,e.pos=m+1,i=e.push("synapse_open","span",1),i.markup="@",i.attrs=[["widgetparams","badge?isUser=true&inlineWidget=true&username="+o],["class",w],["id","widget-"+p+a]],i=e.push("link_open","a",1),i.attrs=[["href","https://www.synapse.org/#!Profile:"+o]],i.markup="autolink",i.info="auto",i=e.push("text","",0),i.content="@"+o+" ",i=e.push("link_close","a",-1),i.markup="autolink",i.info="auto",i=e.push("text","",0),i=e.push("synapse_close","span",-1),e.pos=e.posMax+1,e.posMax=g,p+=1,!0}if(36!==e.src.charCodeAt(m))return!1;if(123!==e.src.charCodeAt(m+1))return!1;for(e.pos=m+2;e.pos<g;){if(125===e.src.charCodeAt(e.pos)){n=!0;break}e.md.inline.skipToken(e)}return n&&m+2!==e.pos?(o=e.src.slice(m+2,e.pos),l=o.replace(f,"$1"),0===o.lastIndexOf(d,0)?(l+="&footnoteId="+u,i=e.push("synapse_reference_open","span",1),i.attrs=[["id","wikiReference"+u]],i=e.push("synapse_reference_close","span",-1),k=decodeURIComponent(l),x=t(k,"text"),x&&(c+="${bookmark?text=["+u+"]&bookmarkID=wikiReference"+u+"} "+x+"\n"),u++,w="inlineWidgetContainer"):0===o.lastIndexOf(h,0)&&(i=e.push("synapse_footnote_target_open","span",1),i.attrs=[["id","wikiFootnote"+u]],i=e.push("synapse_footnote_target_close","span",-1),u++,w="inlineWidgetContainer"),e.posMax=e.pos,e.pos=m+2,i=e.push("synapse_open","span",1),i.markup="${",i.attrs=[["widgetparams",l],["class",w],["id","widget-"+p+a]],i=e.push("text","",0),i.content="<Synapse widget>",i=e.push("synapse_close","span",-1),i.markup="}",e.pos=e.posMax+1,e.posMax=g,p+=1,!0):(e.pos=m,!1)}var a,p,u,c,l,f=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g,d="reference?",h="bookmark?",k=new RegExp("^syn([0-9]+[.]?[0-9]*)+"),x=new RegExp("^([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/w \\.-]*)*\\/?.*$"),g=new RegExp("^doi:10[.]{1}[0-9]+[/]{1}[a-zA-Z0-9_.]+$"),m=new RegExp("^\\s*(width[=]{1})?\\s*(.*)[}]{1}\\s*$"),w=new RegExp("^\\s*[*-+>]{1}[^|]*$"),_=new RegExp("^\\s*\\w+\\s*[.)]{1}[^|]*$"),v=new RegExp("^[`]{3}s*([a-zA-Z_0-9-]*)s*$"),y=new RegExp("[ ]{7}","g");r.exports=function(e,r,n){p=0,u=1,a=r,c="",l="",n&&(l=n),e.inline.ruler.after("emphasis","synapse",i)},r.exports.footnotes=function(){return c},r.exports.resetFootnoteId=function(){u=1},r.exports.preprocessMarkdown=function(e){for(var r="",n=e.split("\n"),t=!1,s=!1,o=!1,i=0;i<n.length;i++)v.test(n[i])&&(o=!o),o||(s=w.test(n[i])||_.test(n[i]),s&&(n[i]=n[i].replace(y,"    ")),t&&!s&&(r+="\n"),t=s),r+=n[i]+"\n";return r},r.exports.init_markdown_it=function(e,r,n,t,s,i,a,p,u,c){function f(){var r=e.renderer.rules.link_open||function(e,r,n,t,s){return s.renderToken(e,r,n)};e.renderer.rules.link_open=function(e,n,t,s,i){var a=e[n].attrIndex("target"),p=e[n].attrIndex("href");return 0>a?(0>p||!o(e[n].attrs[p][1],"#!"))&&e[n].attrPush(["target","_blank"]):e[n].attrs[a][1]="_blank",r(e,n,t,s,i)}}function d(){var r=e.renderer.rules.table_open||function(e,r,n,t,s){return s.renderToken(e,r,n)};e.renderer.rules.table_open=function(e,n,t,s,o){var i=e[n].attrIndex("class");return 0>i?e[n].attrPush(["class","markdowntable"]):e[n].attrs[i][1]+="markdowntable",r(e,n,t,s,o)}}function h(){e.linkify.set({fuzzyLink:!1}),e.linkify.add("syn",{validate:function(e,r,n){var t=e.slice(r);return n.re.synapse||(n.re.synapse=new RegExp("^([0-9]{3,}[.]?[0-9]*(\\/wiki\\/[0-9]+)?)+(?!_)(?=$|"+n.re.src_ZPCc+")")),n.re.synapse.test(t)?t.match(n.re.synapse)[0].length:0},normalize:function(e){e.url=l+"#!Synapse:"+e.url.replace(/[.]/,"/version/")}}),e.linkify.add("doi:10.",{validate:function(e,r,n){var t=e.slice(r);return n.re.doi||(n.re.doi=new RegExp("^[0-9]+[/]{1}[a-zA-Z0-9_.]+(?!_)(?=$|"+n.re.src_ZPCc+")")),n.re.doi.test(t)?t.match(n.re.doi)[0].length:0},normalize:function(e){e.url="http://dx.doi.org/"+e.url}})}function w(r,n){var t,s,o,i,a,p,u,c,f,d,h="",m=r.pos,w=r.posMax,_=r.pos,v=e.helpers.parseLinkLabel,y=e.helpers.parseLinkDestination,C=e.helpers.parseLinkTitle,b=e.utils.isSpace,A=e.utils.normalizeReference;if(91!==r.src.charCodeAt(r.pos))return!1;if(a=r.pos+1,i=v(r,r.pos,!0),0>i)return!1;if(p=i+1,w>p&&40===r.src.charCodeAt(p)){for(p++;w>p&&(s=r.src.charCodeAt(p),b(s)||10===s);p++);if(p>=w)return!1;if(_=p,u=y(r.src,p,r.posMax),u.ok){var M=u.str;k.test(M)?u.str=l+"#!Synapse:"+M.replace(/[.]/,"/version/"):x.test(M)?u.str="http://"+M:g.test(M)&&(u.str="http://dx.doi.org/"+M),h=r.md.normalizeLink(u.str),r.md.validateLink(h)?p=u.pos:h=""}for(_=p;w>p&&(s=r.src.charCodeAt(p),b(s)||10===s);p++);if(u=C(r.src,p,r.posMax),w>p&&_!==p&&u.ok)for(f=u.str,p=u.pos;w>p&&(s=r.src.charCodeAt(p),b(s)||10===s);p++);else f="";if(p>=w||41!==r.src.charCodeAt(p))return r.pos=m,!1;p++}else{if("undefined"==typeof r.env.references)return!1;if(w>p&&91===r.src.charCodeAt(p)?(_=p+1,p=v(r,p),p>=0?o=r.src.slice(_,p++):p=i+1):p=i+1,o||(o=r.src.slice(a,i)),c=r.env.references[A(o)],!c)return r.pos=m,!1;h=c.href,f=c.title}return n||(r.pos=a,r.posMax=i,d=r.push("link_open","a",1),d.attrs=t=[["href",h]],f&&t.push(["title",f]),r.md.inline.tokenize(r),d=r.push("link_close","a",-1)),r.pos=p,r.posMax=w,!0}function _(e,r,n){for(var t,s,o,i=n,a=r,p=e.charCodeAt(n);a>i&&e.charCodeAt(i)===p;)i++;return t=i-n,s=!0,o=!0,{can_open:s,can_close:o,length:t}}function v(e,r){var n,t,s,o=e.pos,i=e.src.charCodeAt(o);if(r)return!1;if(95!==i&&42!==i)return!1;for(t=_(e.src,e.posMax,e.pos),n=0;n<t.length;n++)s=e.push("text","",0),s.content=String.fromCharCode(i),e.delimiters.push({marker:i,jump:n,token:e.tokens.length-1,level:e.level,end:-1,open:t.can_open,close:t.can_close});return e.pos+=t.length,!0}function y(){e.set({html:!1,breaks:!0,linkify:!0,maxNesting:100}),e.disable(["heading"]),e.disable(["lheading"]),e.use(r).use(n).use(t).use(s).use(i).use(a).use(u).use(c),e.use(p,"row",{marker:"{row}",minMarkerCount:1,render:function(e,r){var n;return n=1===e[r].nesting?'<div class="container-fluid"><div class="row">':"</div></div>\n"},validate:function(){return!0}}),e.use(p,"column",{marker:"{column",endMarker:"{column}",minMarkerCount:1,render:function(r,n){var t,s;return 1===r[n].nesting?(t=m.exec(r[n].info),s='<div class="col-sm-'+e.utils.escapeHtml(t[2])+'">'):s="</div>\n",s},validate:function(e){return m.test(e)}}),f(),h(),d(),e.inline.ruler.at("link",w),e.inline.ruler.at("emphasis",v)}y()}},{}]},{},[1])(1)});
